{"version":3,"sources":["webpack:///src/app/pages/visit-subjects/visit-subjects-routing.module.ts","webpack:///src/app/pages/visit-subjects/visit-subjects.module.ts","webpack:///src/app/pages/visit-subjects/visit-subjects.page.html","webpack:///src/app/pages/visit-subjects/visit-subjects.page.ts"],"names":["routes","path","component","loadChildren","then","m","UploaderPageModule","VisitTypePageModule","VisitSubjectsPageRoutingModule","forChild","imports","exports","VisitSubjectsPageModule","declarations","VisitSubjectsPage","alertController","router","cacheService","OPEN_TOGGLER","CLOSE_TOGGLER","MAX_SUBJECTS","ALERT_TEXTS","title","mode","message","okButtonText","ALERT_TEXTS_MINACTIVITY","ALERT_TEXTS_MAXHOREJECUTAR","ALERT_TEXTS_FIELDSEMPTY","subjectsSelected","redirect","textSoporte","validarCoberturaHorasEjecutadas","infoDocumentosPorActividad","length","idActividadDocumentos","i","idActividad","subjects","forEach","element","id","cantidadDocumentos","cantidadDocumentosAdjuntos","limpiarVariablesAsesoria","updateListAdvisoryTopic","subject","isOpen","openedSubjects","filter","s","event","attachDocs","detail","checked","activo","InfoActivityAttachDocs","navigateByUrl","name","subjectForm","controls","setValue","include","emitEvent","toggleIncludeSubject","existe","searchSubject","validate","searchSubject2","estadoInterno","contrato","numeroContrato","push","redirectTo","saveActionLine","lineaAccion","attachments","showInputCode","notification","elementRemove","filteredItems","item","setTimeout","okButton","text","role","alert","create","header","buttons","present","find","subj","SiniestroOpsActividad","listActivMigradas","JSON","parse","sessionStorage","companySelected","listaActividadesMigradas","controlId","controlIdActividad","descripcionActividad","controlObservaciones","observaciones","controlHorasAEjecutar","cantidadHorasEjecutar","controlUnidadMedida","uniadMedidaDescripcion","controlHorasEjecutadas","controlCobertura","undefined","required","min","controlRegistroCodigoEventosEduca","registroCodigoEventosEduca","controlCodeEduca","controlFechaFinContrato","fechaFinContrato","constFirmaConQR","firmamaQR","constEstadoInterno","includedControl","fkIdSiniestro","Fk_Id_Siniestro","siniestro","Siniestro","siniestroOpActividad","addControl","valueChanges","subscribe","v","valor","titulo","notificacion","backdropDismiss","onDidDismiss","actividesSeleccionadas","tarjetas","tarjetasSeleccionadas","encontro","AdjuntarDocumentosTecnicos","CodigoeventoPositiva","codeEduca","formSubject","value","fields","tarjeta","validateCoverage","f","Object","keys","validateTarjetas","resultadoTarjetas","cantidadHorasAEjecutar","coverage","horasEjecutadas","parseInt","horasAEjecutar","actividadesEDValidas","validarActividadesED","unidadMedida","saveMigratedHours","saveActivities","actividadesED","allValid","every","a","t","hasCode","archivos","pdfAdjuntos","arr","fotos","fotosAdjuntas","archivosActividad","indexOf","idTipoArchivo","fotosActividad","archivosAEP","archivosEE","hasFiles","selector","templateUrl","styleUrls"],"mappings":"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","file":"visit-subjects-visit-subjects-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { VisitSubjectsPage } from './visit-subjects.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: VisitSubjectsPage,\n  },\n  {\n    path: 'upload',\n    loadChildren: () => import('../uploader/uploader.module').then(m => m.UploaderPageModule),\n  },\n  {\n    path: 'type',\n    loadChildren: () => import('../visit-type/visit-type.module').then(m => m.VisitTypePageModule),\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class VisitSubjectsPageRoutingModule {}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { IonicModule } from '@ionic/angular';\nimport { VisitSubjectsPageRoutingModule } from './visit-subjects-routing.module';\nimport { VisitSubjectsPage } from './visit-subjects.page';\n\n@NgModule({\n  imports: [CommonModule, FormsModule, ReactiveFormsModule, IonicModule, VisitSubjectsPageRoutingModule],\n  declarations: [VisitSubjectsPage],\n})\nexport class VisitSubjectsPageModule {}\n","<ion-header>\n  <ion-grid>\n    <ion-row>\n      <ion-col size=\"2\">\n        <ion-toolbar color=\"tertiary\">\n          <ion-buttons slot=\"start\">\n            <ion-back-button color=\"primary\" mode=\"md\" defaultHref=\"/\"></ion-back-button>\n          </ion-buttons>\n        </ion-toolbar>\n      </ion-col>\n      <ion-col size=\"10\">\n        <ion-title class=\"titulo\">Temas de asesoría</ion-title>\n      </ion-col>\n    </ion-row>\n  </ion-grid>\n</ion-header>\n\n<ion-content class=\"backgroundContent\">\n  <ion-card *ngFor=\"let subject of subjects; let i = index\" mode=\"ios\">\n    <!-- Código del tema -->\n    <ion-card-header>\n      <ion-item class=\"p-0\" lines=\"none\">\n        <ion-icon [name]=\"subject.isOpen ? CLOSE_TOGGLER : OPEN_TOGGLER\" slot=\"end\" (click)=\"toggleCard(subject)\"> </ion-icon>\n        <ion-card-title class=\"cardTitle\"\n          >{{subject.idActividad}} contrato {{subject.firmamaQR === 1 ? '(Firma con QR)' : '(Firma sin QR)'}}</ion-card-title\n        >\n      </ion-item>\n    </ion-card-header>\n\n    <!-- Detalles del tema -->\n    <ion-card-content [class.ion-hide]=\"!subject.isOpen\">\n      <form [formGroup]=\"subjectForm\">\n        <ion-list class=\"p-0\" lines=\"none\">\n          <!-- Descripción -->\n          <ion-item class=\"p-0\">{{subject.descripcionActividad}}</ion-item>\n\n          <!-- Observaciones -->\n          <ion-item class=\"p-0 mt-5\">\n            <ion-label position=\"stacked\">Observaciones</ion-label>\n            <ion-input class=\"bg-light mt-3 rounded pl-1 pr-1\" readonly> {{subject.observaciones}} </ion-input>\n          </ion-item>\n\n          <ion-item class=\"p-0 mt-3\">\n            <ion-grid>\n              <ion-row>\n                <ion-col size=\"6\" style=\"padding: 5px\">\n                  <!-- Total de personas, muestras, puntos... -->\n                  <p style=\"font-size: 12px\" position=\"stacked\">\n                    Total de {{subject.uniadMedidaDescripcion}}/ Actividad (Estimada {{subject.cantidadHorasEjecutar}})\n                  </p>\n                  <ion-input type=\"tel\" [formControlName]=\"i+'horasEjecutadas'\" id=\"horasEjecutadas\" class=\"bg-light rounded pl-1 pr-1\">\n                  </ion-input>\n                </ion-col>\n                <ion-col size=\"6\" style=\"padding: 5px\">\n                  <!-- Cobertura -->\n                  <p position=\"stacked\">Cobertura</p>\n                  <ion-input\n                    style=\"margin-top: 15px\"\n                    class=\"bg-light rounded pl-1 pr-1\"\n                    type=\"number\"\n                    id=\"cobertura\"\n                    [formControlName]=\"i+'coverage'\"\n                  ></ion-input>\n                </ion-col>\n              </ion-row>\n            </ion-grid>\n          </ion-item>\n\n          <!-- Soportes -->\n          <ion-item class=\"p-0 mt-3 rounded\" color=\"light\">\n            <ion-grid>\n              <ion-row (click)=\"attachDocs(subject)\">\n                <ion-col>\n                  <ion-item class=\"ion-float-start\" color=\"light\">\n                    <ion-badge *ngIf=\"subject.cantidadDocumentos\" slot=\"start\">{{subject.cantidadDocumentos}} </ion-badge>\n                    <ion-label color=\"danger\">Soportes</ion-label>\n                  </ion-item>\n                </ion-col>\n                <ion-col>\n                  <ion-item class=\"ion-float-end\" color=\"light\">\n                    <ion-label color=\"danger\">Adjuntar</ion-label>\n                  </ion-item>\n                </ion-col>\n              </ion-row>\n            </ion-grid>\n          </ion-item>\n\n          <ion-item class=\"mt-3 rounded\" color=\"light\">\n            <ion-label class=\"no-wrap\">{{textSoporte}} se van a adjuntar documentos técnicos por Alissta Web</ion-label>\n            <ion-toggle color=\"primary\" (ionChange)=\"toggleAttachDocs($event, subject)\"> </ion-toggle>\n          </ion-item>\n\n          <ion-item class=\"mt-3 rounded\" color=\"light\" *ngIf=\"subject.lineaAccion === 'ED'\">\n            <ion-label class=\"no-wrap\">Registrar código de evento Educa</ion-label>\n            <ion-toggle color=\"primary\" (ionChange)=\"showInputCodeEdu($event, subject)\"> </ion-toggle>\n          </ion-item>\n\n          <ion-item class=\"mt-3 rounded\" color=\"light\" *ngIf=\"subject.showInputCode\">\n            <ion-label position=\"stacked\">Código de evento Educa</ion-label>\n            <ion-input placeholder=\"Ingrese código de evento Educa\" [formControlName]=\"i+'codeEduca'\" class=\"bg-light mt-3 rounded\">\n            </ion-input>\n          </ion-item>\n\n          <ion-item class=\"ion-float-end no-effects mt-5\" lines=\"none\">\n            <ion-label class=\"ion-text-right\">Incluir esta actividad</ion-label>\n            <ion-checkbox slot=\"end\" color=\"primary\" [formControlName]=\"i+'included'\"> </ion-checkbox>\n          </ion-item>\n        </ion-list>\n      </form>\n    </ion-card-content>\n\n    <!-- Vista contraída de los detalles tema -->\n    <ion-card-content class=\"pt-0\" [class.ion-hide]=\"subject.isOpen\">\n      <ion-list class=\"p-0\" lines=\"none\">\n        <!-- Descripción -->\n        <ion-item class=\"p-0 no-effects\"> {{subject.descripcionActividad}} </ion-item>\n\n        <!-- Acciones -->\n        <ion-item (click)=\"attachDocs(subject)\" lines=\"none\">\n          <ion-badge *ngIf=\"subject.cantidadDocumentos\" slot=\"start\">{{subject.cantidadDocumentos}}</ion-badge>\n          <ion-icon slot=\"start\" name=\"attach-outline\"></ion-icon>\n          <p>Adjuntar documento</p>\n        </ion-item>\n\n        <ion-item class=\"ion-float-end no-effects\" lines=\"none\">\n          <ion-label class=\"ion-text-right\">Incluir esta actividad</ion-label>\n          <ion-checkbox\n            slot=\"end\"\n            color=\"primary\"\n            [(ngModel)]=\"subject.include\"\n            (ngModelChange)=\"emitIncludedOnReactive(subject, i+'included')\"\n          >\n          </ion-checkbox>\n        </ion-item>\n      </ion-list>\n    </ion-card-content>\n  </ion-card>\n\n  <!-- Botón continuar -->\n  <ion-fab vertical=\"bottom\" *ngIf=\"redirectTo\" horizontal=\"center\" slot=\"fixed\" (click)=\"next()\">\n    <ion-button color=\"primary\" mode=\"ios\" expand=\"block\" class=\"btn\"> Continuar </ion-button>\n  </ion-fab>\n</ion-content>\n","import { Component, OnInit } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport { AlertController } from '@ionic/angular';\nimport { CacheService } from '../../services/cache/cache.service';\nimport { VisitSubject } from './visit-subjects.typings';\n\n/**\n * Componente para la vista de temas de visita.\n */\n@Component({\n  selector: 'app-visit-subjects',\n  templateUrl: './visit-subjects.page.html',\n  styleUrls: ['./visit-subjects.page.scss'],\n})\nexport class VisitSubjectsPage implements OnInit {\n  subjectForm: FormGroup;\n\n  /**\n   * Temas de la asesoria.\n   */\n  subjects: VisitSubject[];\n\n  /**\n   * Nombre del ícono para el alternador del tema cuando este está cerrado.\n   */\n  readonly OPEN_TOGGLER = 'chevron-down-outline';\n\n  /**\n   * Nombre del ícono para el alternador del tema cuando este está abierto.\n   */\n  readonly CLOSE_TOGGLER = 'chevron-up-outline';\n\n  /**\n   * Número máximo de temas seleccionados por operación.\n   */\n  private readonly MAX_SUBJECTS = 4;\n\n  /**\n   * Textos para la ventana de diálogo que notifica al usuario que ha seleccionado más temas de los\n   * permitidos.\n   */\n  private readonly ALERT_TEXTS = {\n    title: 'Atención',\n    mode: 'ios',\n    message: 'Puede seleccionar un máximo de cuatro (4) actividades por formulario.',\n    okButtonText: 'Aceptar',\n  };\n\n  /**\n   * Textos para la ventana de diálogo que notifica al usuario que hay que seleccionar por lo menos una\n   * actividad.\n   *\n   */\n  private readonly ALERT_TEXTS_MINACTIVITY = {\n    title: 'Atención',\n    mode: 'ios',\n    message: 'Se debe seleccionar por lo menos (1) actividad para continuar.',\n    okButtonText: 'Aceptar',\n  };\n\n  private readonly ALERT_TEXTS_MAXHOREJECUTAR = {\n    title: 'Atención',\n    mode: 'ios',\n    message: 'No puede seleccionar las actividades, debido a que excede las horas permitidas a ejecutar. Las cuales son 10 horas por día',\n    okButtonText: 'Aceptar',\n  };\n\n  private readonly ALERT_TEXTS_FIELDSEMPTY = {\n    title: 'Atención',\n    mode: 'ios',\n    message: 'Todos los campos son obligatorios',\n    okButtonText: 'Aceptar',\n  };\n\n  /**\n   * Esta variable permitira insertar la actividad seleccionada,\n   * Organizar la interfaz por ahora la pondre any\n   */\n  subjectsSelected: any[] = [];\n\n  /**\n   * redirectTo para cuando se le de continuar\n   */\n  redirectTo: string;\n\n  redirect = true;\n\n  textSoporte = 'NO';\n\n  validarCoberturaHorasEjecutadas = true;\n\n  constructor(\n    private alertController: AlertController,\n    private router: Router,\n    public cacheService: CacheService\n  ) {}\n\n  ionViewWillEnter() {\n    // tslint:disable-next-line: prefer-for-of\n    if (this.cacheService.infoDocumentosPorActividad.length > 0) {\n      // tslint:disable-next-line: prefer-for-of\n      for (let i = 0; i < this.cacheService.infoDocumentosPorActividad.length; i++) {\n        const idActividadDocumentos = this.cacheService.infoDocumentosPorActividad[i].idActividad;\n        this.subjects.forEach(element => {\n          if (element.id === idActividadDocumentos) {\n            element.cantidadDocumentos = this.cacheService.infoDocumentosPorActividad[i].cantidadDocumentosAdjuntos;\n          }\n        });\n      }\n    }\n  }\n\n  ngOnInit() {\n    this.cacheService.limpiarVariablesAsesoria();\n    this.updateListAdvisoryTopic();\n  }\n\n  /**\n   * Muestra u oculta los detalles del tema proporcionado.\n   * Si se está mostrando los detalles de un tema y existe otro abierto, lo cierra.\n   *\n   */\n  toggleCard(subject: VisitSubject): void {\n    subject.isOpen = !subject.isOpen;\n    if (subject.isOpen) {\n      const openedSubjects = this.subjects.filter(s => s !== subject && s.isOpen);\n      openedSubjects.forEach(s => (s.isOpen = false));\n    }\n  }\n\n  /**\n   * Alterna el botón que permite subir archivos o no a un tema.\n   *\n   * @param event Evento que dispara el componente _ion-toggle_.\n   * @param subject Tema actual.\n   */\n  toggleAttachDocs(event: CustomEvent, subject: VisitSubject) {\n    subject.attachDocs = event.detail.checked;\n    const activo = event.detail.checked;\n    if (activo) {\n      this.textSoporte = 'SI';\n    } else {\n      this.textSoporte = 'NO';\n    }\n  }\n\n  /**\n   *\n   */\n  attachDocs(subject: VisitSubject) {\n    this.cacheService.InfoActivityAttachDocs(subject);\n    this.router.navigateByUrl('/u/execLog/pending-visits/visit-id/subjects/upload');\n  }\n\n  emitIncludedOnReactive(subject: VisitSubject, name: string): void {\n    this.subjectForm.controls[name].setValue(subject.include, { emitEvent: false });\n    this.toggleIncludeSubject(subject);\n  }\n\n  /**\n   * Marca para inclusión el tema proporcionado.\n   *\n   * Comprueba también el número máximo de temas seleccionados en la operación actual. Por defecto\n   * es cuatro (4).\n   *\n   * @param subject Tema seleccionado.\n   * @param name Nombre del campo en el formulario reactivo.\n   */\n  async toggleIncludeSubject(subject: VisitSubject): Promise<void> {\n    // subject.include = !subject.include;\n    const existe = this.searchSubject(subject);\n    const validate = this.searchSubject2(subject);\n\n    if (!existe) {\n      subject.estadoInterno = 'Proceso';\n\n      if (this.subjectsSelected.length !== 0 && validate) {\n        // tslint:disable-next-line: prefer-for-of\n        for (let i = 0; i < this.subjectsSelected.length; i++) {\n          const contrato = this.subjectsSelected[i].numeroContrato;\n          if (contrato === this.subjectsSelected[i].numeroContrato) {\n            this.subjectsSelected.push(subject);\n            if (this.subjectsSelected.length > 0) {\n              this.redirectTo = 'type';\n              // Guardar la linea de acción\n              this.cacheService.saveActionLine(this.subjectsSelected[i].lineaAccion);\n\n              if (this.subjectsSelected[i].lineaAccion === 'ED') {\n                const attachments = this.subjectsSelected[i].cantidadDocumentos || 0;\n                const showInputCode = this.subjectsSelected[i].showInputCode;\n\n                if (attachments < 1 && !showInputCode) {\n                  this.notification('Atención', 'Como la linea de acción es EDUCA, es obligatorio cargar los soportes');\n                  this.attachDocs(subject);\n\n                  return;\n                }\n              }\n\n              break;\n            }\n          } else {\n            this.redirectTo = '';\n            this.notification('Atención', 'No se puede seleccionar las actividades con contratos diferentes');\n          }\n        }\n      } else if (validate) {\n        this.subjectsSelected.push(subject);\n        this.redirectTo = 'type';\n        // tslint:disable-next-line: prefer-for-of\n        for (let i = 0; i < this.subjectsSelected.length; i++) {\n          this.cacheService.saveActionLine(this.subjectsSelected[i].lineaAccion);\n\n          if (this.subjectsSelected[i].lineaAccion === 'ED') {\n            const attachments = this.subjectsSelected[i].cantidadDocumentos || 0;\n            const showInputCode = this.subjectsSelected[i].showInputCode;\n\n            if (attachments < 1 && !showInputCode) {\n              this.notification(\n                'Atención',\n                'Como la linea de acción es EDUCA, es obligatorio cargar los soportes Asistencia a eventos de PyP y Evaluación de eventos'\n              );\n              this.attachDocs(subject);\n\n              return;\n            }\n          }\n\n          break;\n        }\n\n        if (this.subjectsSelected.length > 0) {\n          this.redirectTo = 'type';\n        }\n      } else {\n        const elementRemove = subject;\n        const filteredItems = this.subjectsSelected.filter(item => item !== elementRemove);\n        this.subjectsSelected = filteredItems;\n\n        if (this.subjectsSelected.length === 0) {\n          this.redirectTo = '';\n        } else {\n          this.redirectTo = 'type';\n        }\n\n        if (subject.include) {\n          this.notification('Atención', 'Dos actividades de seguimiento a observaciones no se pueden realizar en la misma acta');\n        }\n        setTimeout(() => {\n          subject.include = false;\n        }, 1000);\n      }\n    } else {\n      // subject.include = false;\n      const elementRemove = subject;\n      const filteredItems = this.subjectsSelected.filter(item => item !== elementRemove);\n      this.subjectsSelected = filteredItems;\n\n      if (this.subjectsSelected.length === 0) {\n        this.redirectTo = '';\n      } else {\n        this.redirectTo = 'type';\n      }\n    }\n\n    /**\n     * Valida que el array de las actividades seleccionadas, al descheck no sea igual a 0\n     * de esta manera mostrar una alerta indicando que se debe seleccionar por lo menos 1\n     * actividad.\n     */\n    if (this.subjectsSelected.length === 0) {\n      // subject.include = false;\n      const okButton = {\n        text: this.ALERT_TEXTS_MINACTIVITY.okButtonText,\n        role: 'OK',\n      };\n      const alert = this.alertController.create({\n        header: this.ALERT_TEXTS_MINACTIVITY.title,\n        mode: 'ios',\n        message: this.ALERT_TEXTS_MINACTIVITY.message,\n        buttons: [okButton],\n      });\n\n      (await alert).present();\n\n      return;\n    }\n\n    /**\n     * Valida que el array de las actividades seleccionadas no sean mayores a 4 items\n     */\n    if (this.subjectsSelected.length > this.MAX_SUBJECTS) {\n      // Se desmarca el tema indicado porque se ha alcanzado el máximo permitido\n      // subject.include = false;\n      this.redirectTo = '';\n      const okButton = {\n        text: this.ALERT_TEXTS.okButtonText,\n        role: 'OK',\n      };\n\n      const alert = this.alertController.create({\n        header: this.ALERT_TEXTS.title,\n        mode: 'ios',\n        message: this.ALERT_TEXTS.message,\n        buttons: [okButton],\n      });\n\n      (await alert).present();\n\n      return;\n    }\n    // subject.include = !subject.include;\n  }\n\n  /**\n   * Busca la actividad seleccionada para validar si se checkea o se descheckea para lograr hacer\n   * la gestión del acta de asesoría\n   */\n  searchSubject(subject): boolean {\n    const idActividad = subject.id;\n    const searchSubject = this.subjectsSelected.find(subj => subj.id === idActividad);\n    if (searchSubject) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n  searchSubject2(subject): boolean {\n    if (subject.SiniestroOpsActividad === 5) {\n      const searchSubject = this.subjectsSelected.filter(subj => subj.SiniestroOpsActividad === 5);\n      if (searchSubject.length < 1) {\n        return true;\n      } else {\n        return false;\n      }\n    } else {\n      return true;\n    }\n  }\n\n  /**\n   * Método que agrega los valores de cada actividad migrada a cada una de las tarjetas\n   */\n  updateListAdvisoryTopic() {\n    const listActivMigradas = JSON.parse(sessionStorage.companySelected).listaActividadesMigradas;\n    this.subjects = listActivMigradas;\n    this.subjectForm = new FormGroup({});\n    // tslint:disable-next-line: prefer-for-of\n    for (let i = 0; i < this.subjects.length; i++) {\n      const controlId = new FormControl(this.subjects[i].id);\n      const controlIdActividad = new FormControl(this.subjects[i].idActividad);\n      const descripcionActividad = new FormControl(this.subjects[i].descripcionActividad);\n      const controlObservaciones = new FormControl(this.subjects[i].observaciones);\n      const controlHorasAEjecutar = new FormControl(this.subjects[i].cantidadHorasEjecutar);\n      const controlUnidadMedida = new FormControl(this.subjects[i].uniadMedidaDescripcion);\n      const controlHorasEjecutadas = new FormControl();\n      const controlCobertura = new FormControl(undefined, [Validators.required, Validators.min(1)]);\n      const controlRegistroCodigoEventosEduca = new FormControl(this.subjects[i].registroCodigoEventosEduca);\n      const controlCodeEduca = new FormControl(undefined, [Validators.required]);\n      const controlFechaFinContrato = new FormControl(this.subjects[i].fechaFinContrato);\n      const constFirmaConQR = new FormControl(this.subjects[i].firmamaQR);\n      const constEstadoInterno = new FormControl(this.subjects[i].estadoInterno);\n      const includedControl = new FormControl(this.subjects[i].include);\n      const fkIdSiniestro = new FormControl(this.subjects[i].Fk_Id_Siniestro);\n      const siniestro = new FormControl(this.subjects[i].Siniestro);\n      const siniestroOpActividad = new FormControl(this.subjects[i].SiniestroOpsActividad);\n\n      this.subjectForm.addControl(i + 'id', controlId);\n      this.subjectForm.addControl(i + 'idActividad', controlIdActividad);\n      this.subjectForm.addControl(i + 'descripcionActividad', descripcionActividad);\n      this.subjectForm.addControl(i + 'Observaciones', controlObservaciones);\n      this.subjectForm.addControl(i + 'horasAEjecutar', controlHorasAEjecutar);\n      this.subjectForm.addControl(i + 'unidadMedida', controlUnidadMedida);\n      this.subjectForm.addControl(i + 'horasEjecutadas', controlHorasEjecutadas);\n      this.subjectForm.addControl(i + 'coverage', controlCobertura);\n      this.subjectForm.addControl(i + 'registroCodigoEventosEduca', controlRegistroCodigoEventosEduca);\n      this.subjectForm.addControl(i + 'codeEduca', controlCodeEduca);\n      this.subjectForm.addControl(i + 'fechaFinContrato', controlFechaFinContrato);\n      this.subjectForm.addControl(i + 'firmaQR', constFirmaConQR);\n      this.subjectForm.addControl(i + 'estadoInterno', constEstadoInterno);\n      this.subjectForm.addControl(i + 'included', includedControl);\n      this.subjectForm.addControl(i + 'fkIdSiniestro', fkIdSiniestro);\n      this.subjectForm.addControl(i + 'siniestro', siniestro);\n      this.subjectForm.addControl(i + 'siniestroOpActividad', siniestroOpActividad);\n\n      this.subjectForm.controls[i + 'included'].valueChanges.subscribe(v => {\n        this.subjects[i].include = v;\n        this.toggleIncludeSubject(this.subjects[i]);\n      });\n    }\n  }\n\n  /**\n   * Este metodo permite validar si se muestra el input para el código de educa\n   */\n  showInputCodeEdu(event, subject) {\n    const valor = event.detail.checked;\n    if (valor === true) {\n      subject.showInputCode = true;\n    } else {\n      subject.showInputCode = false;\n    }\n  }\n\n  async notification(titulo, notificacion) {\n    const alert = await this.alertController.create({\n      header: titulo,\n      backdropDismiss: false,\n      mode: 'ios',\n      message: notificacion,\n      buttons: ['ACEPTAR'],\n    });\n\n    alert.onDidDismiss();\n\n    await alert.present();\n  }\n\n  validateTarjetas(actividesSeleccionadas, tarjetas): Array<any> {\n    const tarjetasSeleccionadas = [];\n\n    // tslint:disable-next-line: prefer-for-of\n    for (let i = 0; i < actividesSeleccionadas.length; i++) {\n      const element = actividesSeleccionadas[i];\n      const encontro = tarjetas.find(item => item.id === element.id);\n      if (encontro) {\n        encontro.include = true;\n        encontro.AdjuntarDocumentosTecnicos = element.attachDocs ? 'SI' : 'NO';\n        // encontro.CodigoeventoPositiva = element.registroCodigoEventosEduca;\n        encontro.CodigoeventoPositiva = encontro.codeEduca;\n        tarjetasSeleccionadas.push(encontro);\n      }\n    }\n\n    return tarjetasSeleccionadas;\n  }\n\n  /**\n   * Este metodo valida varias cosas:\n   * 1. Captura el valor de la actividad seleccionada, luego hace un arreglo con los diferentes campos de cada tarjeta.\n   * 2. Recorre los formularios y cada campo para unificarlo en uno solo llamado tarjeta.\n   * 3. Valida entre las actividades seleccionadas cual tiene unidad de medida HORA u Horas para almacenar el total de horas a ejecutar\n   * para las actividades seleccionadas\n   * 4. Valida que exista minimo una seleccionada y no mas de 4 actividades, ademas de validar que dichas actividades seleccionadas\n   * no excedan a las 10 horas por dia\n   * 5. Por ultimo se guarda la información de la tarjeta en el archivo cacheService, esto se utiliza de manera temporal para ir almacenando\n   * cada información ingresada por parte de la gestión del acta de asesoria.\n   */\n\n  async next() {\n    const formSubject = this.subjectForm.value;\n    const fields = [\n      'include',\n      'id',\n      'idActividad',\n      'descripcionActividad',\n      'Observaciones',\n      'horasAEjecutar',\n      'unidadMedida',\n      'horasEjecutadas',\n      'coverage',\n      'registroCodigoEventosEduca',\n      'codeEduca',\n      'fechaFinContrato',\n      'firmaQR',\n      'estadoInterno',\n      'fkIdSiniestro',\n      'siniestro',\n      'siniestroOpActividad',\n    ];\n    let tarjetas = [];\n    for (let i = 0; i < Object.keys(formSubject).length / fields.length; i++) {\n      const tarjeta: any = {};\n      const validateCoverage: any = [];\n      fields.forEach(async f => {\n        tarjeta[f] = formSubject[i + f];\n      });\n      tarjetas.push(tarjeta);\n    }\n    const resultadoTarjetas = await this.validateTarjetas(this.subjectsSelected, tarjetas);\n    tarjetas = resultadoTarjetas;\n    let cantidadHorasAEjecutar = 0;\n\n    // tslint:disable-next-line: prefer-for-of\n    for (let i = 0; i < tarjetas.length; i++) {\n      const element = tarjetas[i];\n      // tslint:disable-next-line: max-line-length\n      if (element.coverage === null || element.coverage === '' || element.horasEjecutadas === null || element.horasEjecutadas === '') {\n        this.validarCoberturaHorasEjecutadas = false;\n        this.notification('Atención', 'Debe ingresar el valor de la cobertura o el de las horas ejecutadas para la actividad seleccionada');\n        break;\n      } else {\n        this.validarCoberturaHorasEjecutadas = true;\n      }\n      if (parseInt(element.horasEjecutadas, 10) > element.horasAEjecutar) {\n        this.validarCoberturaHorasEjecutadas = false;\n        this.notification('Atención', 'La cantidad de horas a ejecutar es mayor a la de horas migradas para realizar la actividad');\n        break;\n      }\n\n      if (parseInt(element.horasEjecutadas, 10) < 1) {\n        this.validarCoberturaHorasEjecutadas = false;\n        this.notification('Atención', 'La hora estimada debe ser mayor a cero');\n        break;\n      }\n\n      if (element.coverage < 1) {\n        this.validarCoberturaHorasEjecutadas = false;\n        this.notification('Atención', 'La cobertura no puede ser menor que uno');\n        break;\n      }\n\n      const actividadesEDValidas = this.validarActividadesED(resultadoTarjetas);\n\n      if (!actividadesEDValidas) {\n        this.validarCoberturaHorasEjecutadas = false;\n        this.notification('Atención', 'Debe adjuntar archivos para las actividades EDUCA o indicar código de evento.');\n        break;\n      }\n\n      if (element.siniestro) {\n        // Es una actividad de investigación\n\n        if (parseInt(element.horasEjecutadas, 10) < element.horasAEjecutar) {\n          // En actividades de investigación solo se permiten registro de actas con el número de horas\n          // de ejecución igual al número de horas migradas\n\n          this.validarCoberturaHorasEjecutadas = false;\n          this.notification('Atención', 'Compruebe que la cantidad de horas ejecutadas coincida con la cantidad de horas migradas.');\n          break;\n        }\n      }\n\n      if (element.unidadMedida === 'HORA' || element.unidadMedida === 'Horas') {\n        // tslint:disable-next-line: radix\n        cantidadHorasAEjecutar = cantidadHorasAEjecutar + parseInt(tarjetas[i].horasEjecutadas);\n      }\n    }\n\n    if (this.validarCoberturaHorasEjecutadas) {\n      if (cantidadHorasAEjecutar <= 10) {\n        this.cacheService.saveMigratedHours(cantidadHorasAEjecutar);\n        if (this.subjectsSelected.length === 0) {\n          const okButton = {\n            text: this.ALERT_TEXTS_MINACTIVITY.okButtonText,\n            role: 'OK',\n          };\n          const alert = this.alertController.create({\n            header: this.ALERT_TEXTS_MINACTIVITY.title,\n            mode: 'ios',\n            message: this.ALERT_TEXTS_MINACTIVITY.message,\n            buttons: [okButton],\n          });\n\n          (await alert).present();\n          return;\n        }\n\n        if (this.subjectsSelected.length > this.MAX_SUBJECTS) {\n          const okButton = {\n            text: this.ALERT_TEXTS.okButtonText,\n            role: 'OK',\n          };\n          const alert = this.alertController.create({\n            mode: 'ios',\n            header: this.ALERT_TEXTS.title,\n            message: this.ALERT_TEXTS.message,\n            buttons: [okButton],\n          });\n          (await alert).present();\n          return;\n        } else {\n          // this.cacheService.saveActivities(this.subjectsSelected);\n          if (this.redirect) {\n            this.cacheService.saveActivities(tarjetas);\n            this.router.navigateByUrl('u/execLog/pending-visits/visit-id/subjects/type');\n          }\n        }\n      } else {\n        const okButton = {\n          text: this.ALERT_TEXTS.okButtonText,\n          role: 'OK',\n        };\n\n        const alert = this.alertController.create({\n          mode: 'ios',\n          header: this.ALERT_TEXTS_MAXHOREJECUTAR.title,\n          message: this.ALERT_TEXTS_MAXHOREJECUTAR.message,\n          buttons: [okButton],\n        });\n\n        (await alert).present();\n      }\n    }\n  }\n\n  private validarActividadesED(tarjetas: any[]): boolean {\n    const actividadesED = this.subjectsSelected.filter(s => s.lineaAccion === 'ED');\n\n    if (!actividadesED.length) {\n      return true;\n    }\n\n    const allValid = actividadesED.every(a => {\n      const tarjeta = tarjetas.find(t => t.id === a.id);\n\n      if (!tarjeta) {\n        return true;\n      }\n\n      const hasCode = !!tarjeta.codeEduca;\n\n      const archivos = [];\n      this.cacheService.pdfAdjuntos.forEach(arr => archivos.push(...arr));\n\n      const fotos = [];\n      this.cacheService.fotosAdjuntas.forEach(arr => fotos.push(...arr));\n\n      const archivosActividad = archivos.filter(f => f.idActividad === tarjeta.id && ['AEP', 'EE'].indexOf(f.idTipoArchivo) >= 0);\n\n      const fotosActividad = fotos.filter(f => f.idActividad === tarjeta.id && ['AEP', 'EE'].indexOf(f.idTipoArchivo) >= 0);\n\n      const archivosAEP =\n        archivosActividad.filter(f => f.idTipoArchivo === 'AEP').length + fotosActividad.filter(f => f.idTipoArchivo === 'AEP').length;\n\n      const archivosEE =\n        archivosActividad.filter(f => f.idTipoArchivo === 'EE').length + fotosActividad.filter(f => f.idTipoArchivo === 'EE').length;\n\n      const hasFiles = archivosAEP >= 1 && archivosEE >= 1;\n\n      return hasCode || hasFiles;\n    });\n\n    return allValid;\n  }\n}\n"]}