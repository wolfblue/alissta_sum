{"version":3,"sources":["webpack:///src/app/pages/responsible-signature-arl/responsible-signature-arl-routing.module.ts","webpack:///src/app/pages/responsible-signature-arl/responsible-signature-arl.module.ts","webpack:///src/app/pages/responsible-signature-arl/responsible-signature-arl.page.html","webpack:///src/app/pages/responsible-signature-arl/responsible-signature-arl.page.ts"],"names":["routes","path","component","ResponsibleSignatureARLPageRoutingModule","forChild","imports","exports","ResponsibleSignatureARLPageModule","declarations","providers","ResponsibleSignatureARLPage","storage","net","modalCtrl","photoService","file","plt","router","loadingCtlr","alertController","cacheService","advisoryTopicService","toastController","signaturePadOptions","maxWidth","minWidth","canvasWidth","canvasHeight","filesBase64","getInfoUser","readFile","get","infoUserARL","firma","signaturePad","toDataURL","split","signatureEntered","concat","clear","infoActa","getAllInfoToAdvisory","create","componentProps","info","modal","present","status","getNetworkStatus","Offline","presentToast","Online","infoSurveyResponsibleARL","responsableId","idPersona","responsableDocumento","responsableNombre","nombres","apellidos","responsableNumeroLicenciaSST","idLicenciaSst","responsableCargo","cargo","responsableRazonSocial","nombreProveedor","responsableFirma","saveSurveyARL","checkNetwork","validateNetwork","idProveedor","actaAsesoriaGestionada","createActaAsesoria","files","getFiles","presentLoading","saveActaAsesoria","toPromise","creacionActa","f","body","UidActaAsesoria","uploadFileActaAsesoria","TTA_lista","length","tta","idActividadMigradaPorUsuario","id","notifCorreoActa","Fk_ID_ActividadMigradaPorUsuario","enviarCorreoNotificacionActaApp","photos","listaActividades","actividadesMigradas","i","listaActividadesMigradas","forEach","element","idActividad","TTA_LISTA","encontro","find","x","splice","set","notification","navigateByUrl","loading","dismiss","activitiesChange","getInfoActaAsesoria","actSelec","JSON","parse","sessionStorage","companySelected","codeActividadesMigradas","activities","estadoInterno","push","cambioCompanySelected","stringify","setItem","saveActasAsesoria","documentosAdjuntados","saveAttach","nombreArchivo","extensionBase","extensionBase64","directory","Data","then","data","base64","objUploadFile","UidActividadMigradaXUSuario","TipoSoporte","tipoDocumento","Base64","deleteFile","message","mode","duration","toast","titulo","notificacion","header","backdropDismiss","buttons","alert","onDidDismiss","imagenesAdjuntas","obtenerAdjuntosFoto","objAdjuntarDoc","j","documento","objAdjuntarImg","idTipoArchivo","foto","base64Imagen","removeFile","drawStart","drawComplete","sendTask","selector","templateUrl","styleUrls"],"mappings":"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","file":"responsible-signature-arl-responsible-signature-arl-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ResponsibleSignatureARLPage } from './responsible-signature-arl.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ResponsibleSignatureARLPage,\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ResponsibleSignatureARLPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ResponsibleSignatureARLPageRoutingModule } from './responsible-signature-arl-routing.module';\n\nimport { ResponsibleSignatureARLPage } from './responsible-signature-arl.page';\n\nimport { SignaturePadModule } from 'angular2-signaturepad';\n\nimport { File } from '@ionic-native/file/ngx';\n\n@NgModule({\n  imports: [CommonModule, FormsModule, SignaturePadModule, IonicModule, ResponsibleSignatureARLPageRoutingModule],\n  declarations: [ResponsibleSignatureARLPage],\n  providers: [File],\n})\nexport class ResponsibleSignatureARLPageModule {}\n","<ion-header>\n  <ion-grid>\n    <ion-row>\n      <ion-col size=\"2\">\n        <ion-toolbar color=\"tertiary\">\n          <ion-buttons slot=\"start\">\n            <ion-back-button color=\"primary\" mode=\"md\" defaultHref=\"/\"></ion-back-button>\n          </ion-buttons>\n        </ion-toolbar>\n      </ion-col>\n      <ion-col size=\"10\">\n        <ion-title class=\"titulo\">Firma responsable ARL</ion-title>\n      </ion-col>\n    </ion-row>\n  </ion-grid>\n</ion-header>\n\n<ion-content>\n  <div class=\"ion-padding\">\n    <div>\n      <h3>Responsable de ARL</h3>\n      <p *ngIf=\"infoUserARL\"><strong>Responsable ARL: </strong> {{infoUserARL.nombres}} {{infoUserARL.apellidos}}</p>\n    </div>\n\n    <div>\n      <h3>Razón social del proveedor</h3>\n      <p *ngIf=\"infoUserARL\"><strong>Nombre proveedor</strong> {{infoUserARL.nombreProveedor}}</p>\n      <p *ngIf=\"infoUserARL\"><strong>Documento proveedor </strong> {{infoUserARL.idProveedor}}</p>\n    </div>\n\n    <div class=\"ion-text-center\">\n      <h4>Firma responsable de ARL</h4>\n    </div>\n    <div style=\"border: 1px solid black\" class=\"firmaContent\">\n      <signature-pad [options]=\"signaturePadOptions\" (onBeginEvent)=\"drawStart()\" (onEndEvent)=\"drawComplete()\"> </signature-pad>\n      <div class=\"ion-text-center\">\n        <p class=\"firma\" *ngIf=\"infoUserARL\">{{infoUserARL.nombres}} {{infoUserARL.apellidos}}</p>\n      </div>\n    </div>\n    <ion-button (click)=\"clear()\" expand=\"block\" fill=\"clear\" shape=\"round\"> Borrar </ion-button>\n  </div>\n\n  <div class=\"ion-text-justify ion-padding\">\n    <p>\n      Al enviar, está autorizando el uso de la su firma ÚNICAMENTE para el registro de la ejecución de las actividades relacionadas en el\n      acta de asesoría en promoción y prevención de POSITIVA COMPAÑÍA DE SEGUROS S.A. La Política de tratamiento de la información la puede\n      consultar en https://www.positiva.gov.co Una vez sea enviado el formulario, recibirá correo electrónico con los soportes de ejecución.\n    </p>\n  </div>\n\n  <div class=\"ion-text-center\" style=\"margin-bottom: 30px\">\n    <ion-grid>\n      <ion-row>\n        <ion-col size=\"3\"></ion-col>\n        <ion-col size=\"6\">\n          <img class=\"btnEnviar\" (click)=\"sendTask()\" src=\"../../../assets/icon/boton_enviar.png\" alt=\"enviar\" />\n        </ion-col>\n        <ion-col size=\"3\"></ion-col>\n      </ion-row>\n    </ion-grid>\n  </div>\n</ion-content>\n","import { Component, OnInit, ViewChild } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Directory, Filesystem } from '@capacitor/filesystem';\nimport { File } from '@ionic-native/file/ngx';\nimport { AlertController, LoadingController, ModalController, Platform, ToastController } from '@ionic/angular';\nimport { Storage } from '@ionic/storage';\nimport { SignaturePad } from 'angular2-signaturepad';\nimport { AdvisoryVerificationComponent } from '../../components/advisory-verification/advisory-verification.component';\nimport { AdvisoryTopicService } from '../../services/activities/advisoryTopic/advisory-topic.service';\nimport { PhotoServiceService } from '../../services/attach/photo-service.service';\nimport { CacheService } from '../../services/cache/cache.service';\nimport { ConnectionStatusEnum, NetworkService } from '../../services/network/network.service';\nimport { CorreoNotificacionActaApp } from 'src/app/intarfaces/interfaces';\n\n@Component({\n  selector: 'app-responsible-signature-arl',\n  templateUrl: './responsible-signature-arl.page.html',\n  styleUrls: ['./responsible-signature-arl.page.scss'],\n})\nexport class ResponsibleSignatureARLPage implements OnInit {\n  private promise: Promise<string>;\n\n  @ViewChild(SignaturePad) signaturePad: SignaturePad;\n\n  // tslint:disable-next-line: ban-types\n  public signaturePadOptions: Object = {\n    maxWidth: 1,\n    minWidth: 1,\n    canvasWidth: 300,\n    canvasHeight: 300,\n  };\n\n  /**\n   * infoUserARL, esta variable permite saber la información del usuario logeado en la aplicación\n   */\n  infoUserARL: any;\n\n  /**\n   * signatureEntered, Es la variable que almacena la firma ingresada por el personal de la ARL.\n   */\n  signatureEntered: any;\n\n  /**\n   * valueNetwork, es la variable que almacena si hay o no internet para proceder a la creación del acta.\n   */\n  valueNetwork: any;\n\n  /**\n   * loading, la variable para mostrar el loading al momento de enviar la información del acta.\n   */\n  loading: any;\n\n  /**\n   * filesBase64, es un arreglo que almacena los base64 de los archivos que han sido leidos, que almacenaron en la actividad.\n   */\n  filesBase64: any[] = [];\n\n  /**\n   * cargaArchivos, es solo una variable donde se almacena el resultado si es exitoso o no la carga del archivo.\n   */\n  cargaArchivos: any;\n\n  /**\n   * actaAsesoriaGestionada, es la variable que almacena la respuesta de la creación del acta de asesoria, por ejemplo: 'true;32'\n   * el cual indica que fue creada con exito y ademas que el 32 es el número del acta de asesoría\n   */\n  actaAsesoriaGestionada: any;\n\n  constructor(\n    private storage: Storage,\n    private net: NetworkService,\n    private modalCtrl: ModalController,\n    private photoService: PhotoServiceService,\n    private file: File,\n    private plt: Platform,\n    private router: Router,\n    private loadingCtlr: LoadingController,\n    private alertController: AlertController,\n    private cacheService: CacheService,\n    private advisoryTopicService: AdvisoryTopicService,\n    private toastController: ToastController\n  ) {}\n\n  ngOnInit() {\n    this.getInfoUser();\n  }\n\n  async ionViewWillEnter() {\n    await this.readFile();\n  }\n\n  async getInfoUser() {\n    this.infoUserARL = await this.storage.get('sesion');\n  }\n\n  drawComplete() {\n    const firma = this.signaturePad.toDataURL().split(',');\n    this.signatureEntered = firma[0].concat(',').concat(' ').concat(firma[1]);\n  }\n\n  drawStart() {\n    // will be notified of szimek/signature_pad's onBegin event\n    // console.log('begin drawing');\n  }\n\n  clear() {\n    this.signaturePad.clear();\n  }\n\n  async verification() {\n    // this.router.navigateByUrl('/u/execLog/pending-visits/visit-id/company-info/comments/survey-signature/advisoryVerification');\n    const infoActa = this.cacheService.getAllInfoToAdvisory();\n    const modal = await this.modalCtrl.create({\n      component: AdvisoryVerificationComponent,\n      componentProps: {\n        info: infoActa,\n      },\n    });\n\n    modal.present();\n  }\n\n  validateNetwork() {\n    const status = this.net.getNetworkStatus();\n\n    if (status === ConnectionStatusEnum.Offline) {\n      this.presentToast();\n    }\n\n    return status === ConnectionStatusEnum.Online;\n  }\n\n  async sendTask() {\n    const infoSurveyResponsibleARL = {\n      responsableId: this.infoUserARL.idPersona,\n      responsableDocumento: this.infoUserARL.idPersona,\n      responsableNombre: this.infoUserARL.nombres + ' ' + this.infoUserARL.apellidos,\n      responsableNumeroLicenciaSST: this.infoUserARL.idLicenciaSst,\n      responsableCargo: this.infoUserARL.cargo,\n      responsableRazonSocial: this.infoUserARL.nombreProveedor,\n      responsableFirma: this.signatureEntered,\n    };\n\n    this.cacheService.saveSurveyARL(infoSurveyResponsibleARL);\n    const checkNetwork = this.validateNetwork();\n    const idProveedor = this.infoUserARL.idProveedor;\n    this.actaAsesoriaGestionada = this.cacheService.createActaAsesoria(idProveedor);\n    const files = this.getFiles();\n\n    if (checkNetwork) {\n      await this.presentLoading('Creando acta de asesoría ...');\n      let creacionActa = await this.advisoryTopicService.saveActaAsesoria(this.actaAsesoriaGestionada).toPromise();\n      creacionActa = creacionActa.split(';');\n      if (creacionActa[0] === 'true' && creacionActa[1] !== '-1') {\n        for (const f of files) {\n          const body = { ...f, UidActaAsesoria: +creacionActa[1] };\n          await this.advisoryTopicService.uploadFileActaAsesoria(body).toPromise();\n        }\n\n        if (this.actaAsesoriaGestionada && this.actaAsesoriaGestionada.TTA_lista && this.actaAsesoriaGestionada.TTA_lista.length > 0) {\n          for (const tta of this.actaAsesoriaGestionada.TTA_lista) {\n            const idActividadMigradaPorUsuario = tta.id;\n\n            // envio correo notificacion acta APP \n            const notifCorreoActa: CorreoNotificacionActaApp = { Fk_ID_ActividadMigradaPorUsuario: idActividadMigradaPorUsuario };\n            await this.advisoryTopicService.enviarCorreoNotificacionActaApp(notifCorreoActa).toPromise();\n          }\n        }\n\n        this.photoService.photos = [];\n        const listaActividades = await this.storage.get('listaActividades');\n\n        for (let i = 0; i < listaActividades.length; i++) {\n          const actividadesMigradas = listaActividades[i].listaActividadesMigradas;\n\n          actividadesMigradas.forEach(element => {\n            const idActividad = element.id;\n            const TTA_LISTA = this.actaAsesoriaGestionada.TTA_lista;\n            const encontro = TTA_LISTA.find(x => x.id === idActividad);\n\n            if (encontro) {\n              actividadesMigradas.splice(encontro, 1);\n              listaActividades[i].listaActividadesMigradas = actividadesMigradas;\n            }\n          });\n        }\n\n        this.storage.set('listaActividades', listaActividades);\n        this.notification('Atención', 'Se ha creado el acta de asesoría');\n        this.router.navigateByUrl('/u/execLog');\n      } else {\n        this.notification('Error', 'No se pudo crear el acta de asesoría');\n      }\n      this.loading.dismiss();\n    } else {\n      const activitiesChange = [];\n      const getInfoActaAsesoria = this.cacheService.getAllInfoToAdvisory();\n      const actSelec = JSON.parse(sessionStorage.companySelected);\n      // tslint:disable-next-line: prefer-for-of\n      for (let i = 0; i < actSelec.listaActividadesMigradas.length; i++) {\n        const codeActividadesMigradas = actSelec.listaActividadesMigradas[i].idActividad;\n        const encontro = getInfoActaAsesoria.activities.find(element => element.idActividad === codeActividadesMigradas);\n        if (encontro) {\n          encontro.estadoInterno = 'Por enviar';\n          activitiesChange.push(encontro);\n        } else {\n          activitiesChange.push(actSelec.listaActividadesMigradas[i]);\n        }\n      }\n      actSelec.listaActividadesMigradas = activitiesChange;\n      const cambioCompanySelected = JSON.stringify(actSelec);\n      sessionStorage.setItem('companySelected', cambioCompanySelected);\n      const saveActaAsesoria = this.cacheService.saveActasAsesoria();\n      if (saveActaAsesoria) {\n        this.notification('Atención', 'Se guardo el acta de asesoría pero con estado pendiente por enviar');\n        this.router.navigateByUrl('/u/execLog');\n      }\n    }\n  }\n\n  async readFile() {\n    const documentosAdjuntados = this.cacheService.saveAttach;\n\n    for (let i = 0; i < documentosAdjuntados.length; i++) {\n      const nombreArchivo = documentosAdjuntados[i].nombreArchivo;\n      const idActividad = documentosAdjuntados[i].idActividad;\n      const extensionBase = documentosAdjuntados[i].extensionBase64;\n\n      try {\n        await Filesystem.readFile({\n          path: `${idActividad}/${nombreArchivo}`,\n          directory: Directory.Data,\n        }).then(data => {\n          const base64 = extensionBase.concat(',').concat(data.data);\n          const objUploadFile = {\n            UidActividadMigradaXUSuario: idActividad,\n            TipoSoporte: documentosAdjuntados[i].tipoDocumento,\n            Base64: base64,\n          };\n          this.filesBase64.push(objUploadFile);\n        });\n      } catch {}\n    }\n  }\n\n  removeFile() {\n    const activities = this.cacheService.saveAttach;\n\n    for (let i = 0; i < activities.length; i++) {\n      const nombreArchivo = activities[i].nombreArchivo;\n      const idActividad = activities[i].idActividad;\n\n      try {\n        Filesystem.deleteFile({\n          path: `${idActividad}/${nombreArchivo}`,\n          directory: Directory.Data,\n        });\n      } catch {}\n    }\n  }\n\n  async presentLoading(message) {\n    this.loading = await this.loadingCtlr.create({\n      mode: 'ios',\n      message,\n    });\n    return this.loading.present();\n  }\n\n  async presentToast() {\n    const toast = await this.toastController.create({\n      message: 'Verifique su conexión a internet.',\n      duration: 2000,\n    });\n    toast.present();\n  }\n\n  async notification(titulo, notificacion) {\n    const alert = await this.alertController.create({\n      header: titulo,\n      backdropDismiss: false,\n      mode: 'ios',\n      message: notificacion,\n      buttons: ['ACEPTAR'],\n    });\n\n    alert.onDidDismiss();\n\n    await alert.present();\n  }\n\n  private getFiles(): any[] {\n    const files: any[] = [];\n    const imagenesAdjuntas = this.cacheService.obtenerAdjuntosFoto();\n\n    for (let i = 0; i < this.filesBase64.length; i++) {\n      const objAdjuntarDoc = this.filesBase64[i];\n      files.push(objAdjuntarDoc);\n    }\n\n    for (let j = 0; j < imagenesAdjuntas.length; j++) {\n      const element = imagenesAdjuntas[j];\n\n      element.forEach(async documento => {\n        const objAdjuntarImg = {\n          UidActividadMigradaXUSuario: documento.idActividad,\n          TipoSoporte: documento.idTipoArchivo,\n          base64: documento.foto.base64Imagen,\n        };\n\n        files.push(objAdjuntarImg);\n      });\n    }\n\n    this.removeFile();\n\n    return files;\n  }\n}\n"]}