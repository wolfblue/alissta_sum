{"version":3,"sources":["webpack:///src/app/pages/pending-visits/pending-visits-routing.module.ts","webpack:///src/app/pages/pending-visits/pending-visits.module.ts","webpack:///src/app/pages/pending-visits/pending-visits.page.html","webpack:///src/app/pages/pending-visits/pending-visits.page.ts"],"names":["routes","path","component","loadChildren","then","m","VisitPageModule","PendingVisitsPageRoutingModule","forChild","imports","exports","PendingVisitsPageModule","declarations","PendingVisitsPage","listActivitiesCompany","network","storage","net","loadingCtlr","router","listActivity","textoBuscar","moduloBuscar","showListPendingVisit","isConnected","validateDataListActivities","showIPAddress","event","detail","value","activity","i","listaActividadesMigradas","length","estadoInterno","sessionStorage","companySelected","JSON","stringify","presentLoading","get","documentoUsuario","setTimeout","listActivityForCompany","idPersona","subscribe","response","console","log","actasGuardadas","forEach","a","filter","aa","find","aaa","activities","aaaa","id","undefined","set","listDepartamentos","listMunicipios","listArchivosSoporte","loading","dismiss","err","create","mode","message","present","dataListActivities","search","searchModulo","listActivities","selector","templateUrl","styleUrls"],"mappings":"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","file":"pending-visits-pending-visits-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { PendingVisitsPage } from './pending-visits.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: PendingVisitsPage,\n  },\n  {\n    path: ':id',\n    loadChildren: () => import('../visit/visit.module').then(m => m.VisitPageModule),\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class PendingVisitsPageRoutingModule {}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { IonicModule } from '@ionic/angular';\nimport { PendingVisitsPageRoutingModule } from './pending-visits-routing.module';\nimport { PendingVisitsPage } from './pending-visits.page';\nimport { PipesModule } from '../../pipes/pipes.module';\nimport { ScrollingModule } from '@angular/cdk/scrolling';\n\n@NgModule({\n  imports: [CommonModule, FormsModule, IonicModule, PipesModule, ScrollingModule, PendingVisitsPageRoutingModule],\n  declarations: [PendingVisitsPage],\n})\nexport class PendingVisitsPageModule {}\n","<ion-header class=\"ion-no-border\">\n  <ion-grid>\n    <ion-row>\n      <ion-col size=\"2\">\n        <ion-toolbar>\n          <ion-buttons slot=\"start\">\n            <ion-back-button mode=\"md\" color=\"primary\" defaultHref=\"/\"></ion-back-button>\n          </ion-buttons>\n        </ion-toolbar>\n      </ion-col>\n      <ion-col size=\"10\">\n        <ion-searchbar animated color=\"primary\" placeholder=\"Buscar\" (ionChange)=\"search($event)\"> </ion-searchbar>\n      </ion-col>\n    </ion-row>\n    <ion-row>\n      <ion-col size=\"12\">\n        <ion-item>\n          <ion-label>Módulo</ion-label>\n          <ion-select placeholder=\"Seleccionar módulo\" (ionChange)=\"searchModulo($event)\">\n            <ion-select-option value=\"GEM\">Gran Empresa</ion-select-option>\n            <ion-select-option value=\"GMP\">Gran MiPyme</ion-select-option>\n            <ion-select-option value=\"GCT\">Grandes Cuentas</ion-select-option>\n            <ion-select-option value=\"ASE\">Asistencia/Asesoría</ion-select-option>\n            <ion-select-option value=\"INV\">Investigación AT</ion-select-option>\n            <ion-select-option value=\"REC\">Reclasificación</ion-select-option>\n            <ion-select-option value=\"\">Todos</ion-select-option>\n          </ion-select>\n        </ion-item>\n      </ion-col>\n    </ion-row>\n  </ion-grid>\n</ion-header>\n\n<ion-content class=\"ion-padding\">\n  <ion-slides mode=\"ios\" *ngIf=\"listActivity.length == 0\">\n    <ion-slide>\n      <ion-grid>\n        <ion-row>\n          <ion-col size=\"12\">\n            <div class=\"ion-text-center\">\n              <img class=\"imgIcono\" src=\"../../../assets/icon/icono_observaciones.svg\" alt=\"\" />\n            </div>\n          </ion-col>\n        </ion-row>\n        <ion-row>\n          <ion-col size=\"12\">\n            <strong>\n              <h3 class=\"titulo\">Recuerde sincronizar las actividades que va a ejecutar aquí.</h3>\n            </strong>\n          </ion-col>\n        </ion-row>\n        <ion-row>\n          <ion-col size=\"12\">\n            <ion-icon name=\"arrow-down-outline\"></ion-icon>\n          </ion-col>\n        </ion-row>\n      </ion-grid>\n    </ion-slide>\n  </ion-slides>\n\n  <!-- Esto cuando se este consumiendo el servicio -->\n\n  <cdk-virtual-scroll-viewport itemSize=\"150\" minBufferPx=\"750\" maxBufferPx=\"1500\">\n    <ion-list *ngIf=\"listActivity.length >= 1\">\n      <ion-item\n        color=\"secondary\"\n        routerLink=\"./visit-id\"\n        *cdkVirtualFor=\"let activity of listActivity | searchCompanyList: textoBuscar : ['numeroDocumento', 'name']: moduloBuscar; let i = index\"\n        (click)=\"companySelected(activity)\"\n        detail\n      >\n        <div style=\"width: 100%\">\n          <ion-label class=\"labelEnProceso\">En proceso 0 de {{activity.listaActividadesMigradas.length}}</ion-label>\n          <ion-grid>\n            <ion-row>\n              <ion-col size=\"12\">\n                <ion-label>{{activity.name}}</ion-label>\n              </ion-col>\n            </ion-row>\n            <ion-row>\n              <ion-col size=\"12\">\n                <ion-label>{{activity.tipoDocumentoDescripcion}} {{activity.numeroDocumento}}</ion-label>\n              </ion-col>\n            </ion-row>\n            <ion-row>\n              <ion-col size=\"12\">\n                <ion-label>Módulo: <span class=\"nombre-modulo\">{{activity.ModuloNombre}}</span></ion-label>\n              </ion-col>\n            </ion-row>\n          </ion-grid>\n        </div>\n      </ion-item>\n    </ion-list>\n  </cdk-virtual-scroll-viewport>\n\n  <!-- Descargar visitas -->\n  <ion-fab vertical=\"bottom\" horizontal=\"center\" slot=\"fixed\">\n    <ion-fab-button (click)=\"listActivities()\">\n      <ion-icon name=\"cloud-download-outline\"></ion-icon>\n    </ion-fab-button>\n  </ion-fab>\n</ion-content>\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Network } from '@ionic-native/network/ngx';\nimport { LoadingController } from '@ionic/angular';\nimport { Storage } from '@ionic/storage';\nimport { ActivityListCompanyService } from '../../services/activities/activityListCompany/activity-list-company.service';\nimport { NetworkService } from '../../services/network/network.service';\n\n/**\n * Componente de la vista de visitas pendientes.\n */\n@Component({\n  selector: 'app-pending-visits',\n  templateUrl: './pending-visits.page.html',\n  styleUrls: ['./pending-visits.page.scss'],\n})\nexport class PendingVisitsPage implements OnInit {\n  listActivity: any[] = [];\n\n  textoBuscar = '';\n  moduloBuscar = '';\n  loading: any;\n\n  // Para la prueba\n  showListPendingVisit = true;\n\n  isConnected = false;\n\n  constructor(\n    private listActivitiesCompany: ActivityListCompanyService,\n    private network: Network,\n    private storage: Storage,\n    private net: NetworkService,\n    private loadingCtlr: LoadingController,\n    private router: Router\n  ) {}\n\n  ngOnInit() {\n    this.validateDataListActivities();\n    this.net.showIPAddress();\n  }\n\n  /**\n   * Establece el texto a buscar en la lista\n   *\n   * @param event texto a buscar\n   */\n  search(event: any) {\n    this.textoBuscar = event.detail.value;\n  }\n\n  /**\n   * Establece el filtrado por modulo\n   *\n   * @param event modulo a buscar\n   */\n  searchModulo(event: any) {\n    this.moduloBuscar = event.detail.value;\n  }\n\n  companySelected(activity: any) {\n    // tslint:disable-next-line: prefer-for-of\n    for (let i = 0; i < activity.listaActividadesMigradas.length; i++) {\n      activity.listaActividadesMigradas[i].estadoInterno = 'Migradas';\n    }\n    sessionStorage.companySelected = JSON.stringify(activity);\n  }\n\n  async listActivities() {\n    this.presentLoading();\n    const documentoUsuario = await this.storage.get('sesion');\n\n    setTimeout(() => {\n      this.listActivitiesCompany.listActivityForCompany(documentoUsuario.idPersona).subscribe(\n        async response => {\n          console.log('Respuesta de actividade', response);\n\n          const listActivity = response.listActivitiesCompany || [];\n          const actasGuardadas: any[] = (await this.storage.get('actasAsesoriaSinInternet')) || [];\n\n          listActivity.forEach((a: any) => {\n            a.listaActividadesMigradas = a.listaActividadesMigradas.filter(\n              (aa: any) => actasGuardadas.find(aaa => aaa.activities.find((aaaa: any) => aaaa.id === aa.id)) === undefined\n            );\n          });\n\n          this.storage.set('departamentos', response.listDepartamentos);\n          this.storage.set('municipios', response.listMunicipios);\n          this.storage.set('listArchivosSoporte', response.listArchivosSoporte);\n\n          // Guardar las actividades en un BD local.\n          this.storage.set('listaActividades', listActivity);\n          this.validateDataListActivities();\n          this.showListPendingVisit = false;\n          this.loading.dismiss();\n        },\n        err => {\n          this.loading.dismiss();\n          this.showListPendingVisit = false;\n        }\n      );\n    }, 2000);\n  }\n\n  async presentLoading() {\n    this.loading = await this.loadingCtlr.create({\n      mode: 'ios',\n      message: 'Cargando',\n    });\n    return this.loading.present();\n  }\n\n  async validateDataListActivities() {\n    const dataListActivities = await this.storage.get('listaActividades');\n\n    if (dataListActivities) {\n      this.listActivity = dataListActivities.filter((a: any) => a.listaActividadesMigradas.length > 0);\n    } else {\n      this.listActivity = [];\n    }\n  }\n}\n"]}